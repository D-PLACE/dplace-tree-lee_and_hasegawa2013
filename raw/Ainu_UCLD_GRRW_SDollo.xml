<?xml version="1.0" standalone="yes"?>

<!-- Generated by BEAUTi v1.7.x                                              -->
<!--       by Alexei J. Drummond, Andrew Rambaut and Marc A. Suchard         -->
<!--       Department of Computer Science, University of Auckland and        -->
<!--       Institute of Evolutionary Biology, University of Edinburgh        -->
<!--       David Geffen School of Medicine, University of California, Los Angeles-->
<!--       http://beast.bio.ed.ac.uk/                                        -->








<!--    *INSTRUCTION* For BEAST analysis with geographical priors: put 'Umi.kml' and 'Ainu_UCLD_GRRW_SDollo.xml" file into the same folder and run the xml with the latest version of BEAST http://beast.bio.ed.ac.uk/ For further inquiry: seanlee@darwin.c.u-tokyo.ac.jp   -->








 <beast>

	<!-- The list of taxa to be analysed (can also include dates/ages).          -->
	<!-- ntax=19                                                                 -->
	<taxa id="taxa">
		<taxon id="Yakumo">
			<attr name="trait">
				42.256007 140.265284
			</attr>
		</taxon>
		<taxon id="Oshamambe">
			<attr name="trait">
				42.513702 140.380632
			</attr>
		</taxon>
		<taxon id="Horobetsu">
			<attr name="trait">
				42.409601 141.109069
			</attr>
		</taxon>
		<taxon id="Hiratori">
			<attr name="trait">
				42.585088 142.128522
			</attr>
		</taxon>
		<taxon id="Nukkibetsu">
			<attr name="trait">
				42.672777 142.263151
			</attr>
		</taxon>
		<taxon id="Niikappu">
			<attr name="trait">
				42.362416 142.318331
			</attr>
		</taxon>
		<taxon id="Samani">
			<attr name="trait">
				42.127860 142.933550
			</attr>
		</taxon>
		<taxon id="Obihiro">
			<attr name="trait">
				42.923893 143.196105
			</attr>
		</taxon>
		<taxon id="Kushiro">
			<attr name="trait">
				42.984855 144.381357
			</attr>
		</taxon>
		<taxon id="Bihoro">
			<attr name="trait">
				43.823785 144.107042
			</attr>
		</taxon>
		<taxon id="Asahikawa">
			<attr name="trait">
				43.770630 142.364786
			</attr>
		</taxon>
		<taxon id="Nayoro">
			<attr name="trait">
				44.355935 142.463164
			</attr>
		</taxon>
		<taxon id="Soya">
			<attr name="trait">
				45.486586 141.880246
			</attr>
		</taxon>
		<taxon id="Ochiho">
			<attr name="trait">
				46.918326 143.085711
			</attr>
		</taxon>
		<taxon id="Tarantomari">
			<attr name="trait">
				46.858530 141.966218
			</attr>
		</taxon>
		<taxon id="Maoka">
			<attr name="trait">
				47.062474 142.061314
			</attr>
		</taxon>
		<taxon id="Shiraura">
			<attr name="trait">
				47.854339 142.510009
			</attr>
		</taxon>
		<taxon id="Raichishka">
			<attr name="trait">
				48.421654 142.081988
			</attr>
		</taxon>
		<taxon id="Nairo">
			<attr name="trait">
				49.100515 142.948565
			</attr>
		</taxon>
	</taxa>
	
    <taxa id="Karafuto">
		<taxon idref="Maoka"/>
		<taxon idref="Nairo"/>
		<taxon idref="Ochiho"/>
		<taxon idref="Raichishka"/>
		<taxon idref="Shiraura"/>
		<taxon idref="Tarantomari"/>
	</taxa>
    <taxa id="Hokkaido">
		<taxon idref="Yakumo"/>
		<taxon idref="Oshamambe"/>
		<taxon idref="Horobetsu"/>
		<taxon idref="Hiratori"/>
		<taxon idref="Nukkibetsu"/>
		<taxon idref="Niikappu"/>
        <taxon idref="Samani"/>
		<taxon idref="Obihiro"/>
		<taxon idref="Kushiro"/>
		<taxon idref="Bihoro"/>
		<taxon idref="Asahikawa"/>
		<taxon idref="Nayoro"/>
        <taxon idref="Soya"/>
	</taxa>
    
    <!-- Stochastic Binary Dollo Model -->
    <extendedDataType id="bdDataType">
		<extantState code="1"/>
		<deathState code="0"/>
		<ambiguity code="?"/>
	</extendedDataType>

	<!-- The sequence alignment (each sequence refers to a taxon above).         -->
	<!-- ntax=19 nchar=351                                                       -->
	<alignment id="alignment" >
		<dataType idref="bdDataType"/>
        
		<sequence>
			<taxon idref="Yakumo"/>
			010011101001010100010011111011111111101110100101011111101111111110110010010101010110000111111101110100100001110110111010100110011110010101100111110011111011111011010010010010100101001011111101111110100110000000110111010100111110001000111110001000100001111011111111111111001111101100111111010010001001001010101011010000101001001101100101111010000101001
		</sequence>
		<sequence>
			<taxon idref="Oshamambe"/>
			0100111010010??1000100111110101111011011101001010111111011111111101010100101010101010001111111011101001000011011101110101001100111100101011001111???111110111110101100100100101001010010111111011111101001100000001101010101001111010010001111100010001000011110111111111111110011111001001111110100100010010010101010???10000101001000101100101111010000101001
		</sequence>
		<sequence>
			<taxon idref="Horobetsu"/>
			010011101001110100010011111010111101101110100101011111101111111110101010010101010100100111111101110100100001110110111010100101011110010101100111101011111011111011010010010010100101001111111101111110100101000000110110101010111111001000111111001000010001111011111111111111001111100100111111010010001001001110111010010000100101001101100101111011000011001
		</sequence>
		<sequence>
			<taxon idref="Hiratori"/>
			010011100100110100010011111011111101101110100101011111101111111110110010010101010101000111111101110100100001110110111010100101011110010101100111110111111011111011010010001010010101001111111101111110100110000000110010101001111111001000111101001000011001111011111111111111001111100100111111110010001001001110011000110000101101001101100101111010000011001
		</sequence>
		<sequence>
			<taxon idref="Nukkibetsu"/>
			010011100100110100010011111010111101101110100??1011111101111111110110010010101010101000111111101110100100001110110111010100101011110010101100111????111110111110101100100010100101010001111111011111101001001000001100101100011111010010001111010010000100011110111111111111110011111001001111110100????1001001010010100110000101001000101100011111010000011001
		</sequence>
		<sequence>
			<taxon idref="Niikappu"/>
			010011100100110100010011111010111101101110100101011111101111111110110010010101010101000111111101110100100001101110111010100101011110010101100111110011111011111011010010001010010??100011111110111111010010001000011010010100111111000100011110100100001000111101111111111111100111110010011111101001000???100101001010011000010010100???1100101111010000011001
		</sequence>
		<sequence>
			<taxon idref="Samani"/>
			0100111010010011000100111110101111011011101001010111110111111111101010100101010101100001111111011011000100011011101110101001001111010101011001111100111110111?10110100100100011000110010111111011111101001000010001101001100101111001010001111001010001000011110111111111111110011111001001111110100100010001010100110???01000101000101101100101111010000011001
		</sequence>
		<sequence>
			<taxon idref="Obihiro"/>
			010011101001010100010011111010111101101110100101011111101111111110110010010100110110000111111101101100001001110110111010100100111101110101100111110111111011111011010010010001100011001111111011111110100100001000110101001010111101000100111100101000010001111011111111111111001111010100111111010010001000100110111010101100101001001101100101111010100011001
		</sequence>
		<sequence>
			<taxon idref="Kushiro"/>
			010011101001010100010011111010111101101110100101011111101111111110101010010011010110000111111101101100001001110110111010100100111110110101100111????111110111110110100100100011000110010111110111111101001000010001101001010101111????00101111001010000100011110111111111111110011110101001111110100100010001001100110???00010??1001001101100101111010000011001
		</sequence>
		<sequence>
			<taxon idref="Bihoro"/>
			010011101001010100010011111010111101101110100100111111101111111110111010010101001110000111111101110100001001110110111010010100111101010101010111110111111011111011010010010001100001001011111011111110100100001100110101001010111110000011111100101000010001111011111111111111001111010100111111010010001000100110011010111000101001001101100101111010000011001
		</sequence>
		<sequence>
			<taxon idref="Asahikawa"/>
			010011??10010101000100111110111111011011101001010111111011111111101110100101010101100001111111011101001010011101101110101001001111101101011001111100111110111110110??????1001010010???11111111011111101001????????110100101010111101000001111101100100000101111011111111111111001111101000111111010001001000101010011000100110101001001001100101110110000011001
		</sequence>
		<sequence>
			<taxon idref="Nayoro"/>
			0100111010010101000100111110111111011011101000110111111011111111111100100101010011100001111111011101001000011101101110101001001111100011011001111???11111011111010110010010010100111001111111111111110100101000000110010101011111110000001111100100100000101111111111111111111001111010100111111110001101000101110111000100100101001001001100101111010100011001
		</sequence>
		<sequence>
			<taxon idref="Soya"/>
			001011??10011101000100111110101111011011101101010111111011111111011100100101010011100001111111011100101000011101011110100011001111101111111001111100111110111110101??????1000110010100101111110111111010010000001011001011001011111000001011110010100010000111011111111111111100111110????111110111001100100100110011010100100101001001101010101111000010011001
		</sequence>
		<sequence>
			<taxon idref="Ochiho"/>
			000111??0010101010010011110101111101111101010101011111101111111101110001010101010101000111111011110100000101101101111010001101011110001011001111?1001111101111101010100100011000110010101111110111110101010000000111001101001011110001000111110010?????????1110111111111111111001111100011111110110000010100010101011010000001010010010011010101111000001010101
		</sequence>
		<sequence>
			<taxon idref="Tarantomari"/>
			000111010010110011011111110101111101101101110101111111101111111101110101010101011100010111111011110100000011101101110101001101011100101011001111110011111011110111001001000110001100101011111101111101001100000001110010101010111100010001111100100010000011110111111111111110101111100010111110101000010100010101011010000001010011001001011101111000010011001
		</sequence>
		<sequence>
			<taxon idref="Maoka"/>
			001111010010101010011011110101111101111101011101111111101111111101110001010101010100010111111011110001000101101101111010001101011100101011001111110011111011111111101001000110001100101011111101111101001100000001110010101010111100010001111100010010000011110111111111111110011111101010111110101000010100100101011010000001010011001101011101111000001011001
		</sequence>
		<sequence>
			<taxon idref="Shiraura"/>
			011011010010101010010011110101111101011101010100111111101111111101100101001101010100010111111011110100000101101101111010001101011110001011001111110011111011111011001001000110001100101011111101111101001100000001110010110010111100010001111100010010000011110111111111111111001111100001111110110000100010100101011010000001010011001001010101111001000010101
		</sequence>
		<sequence>
			<taxon idref="Raichishka"/>
			010111010010101010111111110101111101011101110101011111101111111101110101001101001100010111111011110100000101101101111010001101011110001011001111110011111011111011001101100110001100111011111101111101001100000001101010101010111100010001111100010001100001110111111111111110011111100010111110100100010010010101011010000001010011001101010101111001000010101
		</sequence>
		<sequence>
			<taxon idref="Nairo"/>
			011111010010101010010111110101111101011101010101111111101111111101110100110101010100001111111011110100000101101101111010100101011110001011001111110011110111111011001001000110001100101011111101111101001100000001110010101010111100010001111100010010000011110111111111111111001111101000111110110000010100010101011010000001010011001001010101111000001010011
		</sequence>
	</alignment>

    <!-- Correction for ascertainment bias                                       -->
    <ascertainedPatterns from="1" id="patterns">
        <alignment idref="alignment"/>
        <excludePatterns from="1" to="1"/>
    </ascertainedPatterns>

	<newick id="startingTree">
      ((Soya:677.9837811542398,((Asahikawa:284.0551009118723,Nayoro:284.0551009118723):204.84575442059077,((Samani:302.37881916856713,(Bihoro:188.05996265030115,(Obihiro:150.60102259767746,Kushiro:150.60102259767746):37.45894005262369):114.31885651826599):153.43733621849776,((((Niikappu:93.41464071381677,Nukkibetsu:93.41464071381677):34.05188504173179,Hiratori:127.46652575554856):131.61755013591392,Horobetsu:259.0840758914625):83.35489289078737,(Yakumo:111.24099186141609,Oshamambe:111.24099186141609):231.19797692083375):113.37718660481505):33.08469994539814):189.0829258217767):909.7742355049573,((Ochiho:325.41631213730045,((Raichishka:224.95428536409622,Shiraura:224.95428536409622):62.5899870655652,Nairo:287.5442724296614):37.87203970763903):37.83126605465577,(Tarantomari:216.23752826690372,Maoka:216.23752826690372):147.0100499250525):1224.5104384672409)  
    </newick>

	<!-- Generate a tree model                                                   -->
	<treeModel id="treeModel">
		<coalescentTree idref="startingTree"/>
		<rootHeight>
			<parameter id="treeModel.rootHeight"/>
		</rootHeight>
		<nodeHeights internalNodes="true">
			<parameter id="treeModel.internalNodeHeights"/>
		</nodeHeights>
		<nodeHeights internalNodes="true" rootNode="true">
			<parameter id="treeModel.allInternalNodeHeights"/>
		</nodeHeights>
        <nodeTraits name="trait" rootNode="true" internalNodes="false" leafNodes="false" traitDimension="2">
			<parameter id="rootTrait"/>
		</nodeTraits>
		<nodeTraits name="trait" rootNode="true" internalNodes="true" leafNodes="false" traitDimension="2">
			<parameter id="internalTraits"/>
		</nodeTraits>
		<nodeTraits name="trait" rootNode="true" internalNodes="true" leafNodes="true" traitDimension="2">
			<parameter id="allTraits"/>
		</nodeTraits>        
	</treeModel>

	
	<!-- Generate a generalizedSkyLineLikelihood for Bayesian Skyline            -->
	<generalizedSkyLineLikelihood id="skyline" linear="false">
		<populationSizes>
			<parameter id="skyline.popSize" dimension="5" value="1000.0 1000.0 1000.0 1000.0 1000.0" lower="0.0 0.0 0.0 0.0 0.0" upper="Infinity Infinity Infinity Infinity Infinity"/>
		</populationSizes>
		<groupSizes>
			<parameter id="skyline.groupSize" dimension="5"/>
		</groupSizes>
		<populationTree>
			<treeModel idref="treeModel"/>
		</populationTree>
	</generalizedSkyLineLikelihood>	
	<exponentialMarkovLikelihood id="eml1" jeffreys="true">
		<chainParameter>
			<parameter idref="skyline.popSize"/>
		</chainParameter>        
	</exponentialMarkovLikelihood>

	<!-- The uncorrelated relaxed clock (Drummond, Ho, Phillips & Rambaut (2006) PLoS Biology 4, e88 )-->
	<discretizedBranchRates id="branchRates">
		<treeModel idref="treeModel"/>
		<distribution>
			<logNormalDistributionModel meanInRealSpace="true">
				<mean>
					<parameter id="ucld.mean" value="1.0"/>
				</mean>
				<stdev>
					<parameter id="ucld.stdev" value="0.01" lower="0.0" upper="10.0"/>
				</stdev>
			</logNormalDistributionModel>
		</distribution>
		<rateCategories>
			<parameter id="branchRates.categories" dimension="36"/>
		</rateCategories>
	</discretizedBranchRates>    
	<rateStatistic id="meanRate" name="meanRate" mode="mean" internal="true" external="true">
		<treeModel idref="treeModel"/>
		<discretizedBranchRates idref="branchRates"/>
	</rateStatistic>    
	<rateStatistic id="coefficientOfVariation" name="coefficientOfVariation" mode="coefficientOfVariation" internal="true" external="true">
		<treeModel idref="treeModel"/>
		<discretizedBranchRates idref="branchRates"/>
	</rateStatistic>	
    <rateCovarianceStatistic id="covariance" name="covariance">
		<treeModel idref="treeModel"/>
		<discretizedBranchRates idref="branchRates"/>
	</rateCovarianceStatistic>
    
	<!-- site model                                                              -->
	<siteModel id="siteModel">
    	<substitutionModel>            
			<mutationDeathModel id="cognateModel">
				<parameter id="cognate.loss" lower="0.0" value="0.00023"/>
				<dataType idref="bdDataType"/>
			</mutationDeathModel>            
    	</substitutionModel>
    	<mutationRate>
			<parameter id="overallRate" lower="0.0" value="1.0"/>
    	</mutationRate>
    </siteModel>
    <alsTreeLikelihood id="bdLikelihood" useScaling="false" useAmbiguities="true" integrateGainRate="true">
    	<ascertainedPatterns idref="patterns"/>
    	<treeModel idref="treeModel"/>
    	<siteModel idref="siteModel"/>
    	<observationProcess type="anyTip"/>
 		<discretizedBranchRates idref="branchRates"/>
    </alsTreeLikelihood>    
	<multivariateDiffusionModel id="diffusionModel">
		<precisionMatrix>
			<matrixParameter id="precisionMatrix">
				<parameter id="col1" value="0.05 0.002"/>
				<parameter id="col2" value="0.002 0.05"/>
			</matrixParameter>
		</precisionMatrix>        
	</multivariateDiffusionModel>
	<multivariateWishartPrior id="precisionPrior" df="2">
		<scaleMatrix>
			<matrixParameter>
				<parameter value="1.0 0.0"/>
				<parameter value="0.0 1.0"/>
			</matrixParameter>
		</scaleMatrix>
		<data>
			<matrixParameter idref="precisionMatrix"/>
		</data>        
	</multivariateWishartPrior>
	<multivariateNormalPrior id="rootPrior">
        <meanParameter>
            <parameter value="0.0 0.0"/>
        </meanParameter>
	   	<precisionParameter>
	 		<matrixParameter>
	   			<parameter value="0.001 0.0"/>
	   			<parameter value="0.0 0.001"/>
	 		</matrixParameter>
	   	</precisionParameter>
	  	<data>
	 		<parameter idref="rootTrait"/>
	  	</data>
    </multivariateNormalPrior>    
    <discretizedBranchRates id="branchRatesDiffusion">
		<treeModel idref="treeModel"/>
		<distribution>
			<onePGammaDistributionModel>
				<shape>
                    <parameter id="diffusion.halfDF" value="0.5"/>
				</shape>
			</onePGammaDistributionModel>
		</distribution>
		<rateCategories>
			<parameter id="branchRatesDiffusion.categories"/>
		</rateCategories>
	</discretizedBranchRates>
	<rateStatistic id="meanRateDiffusion" name="meanRate" mode="mean" internal="true" external="true">
		<treeModel idref="treeModel"/>
		<discretizedBranchRates idref="branchRatesDiffusion"/>
	</rateStatistic>	
	<rateStatistic id="coefficientOfVariationDiffusion" name="coefficientOfVariationDiffusion" mode="coefficientOfVariation" internal="true" external="true">
		<treeModel idref="treeModel"/>
		<discretizedBranchRates idref="branchRatesDiffusion"/>
	</rateStatistic>	
	<rateCovarianceStatistic id="covarianceDiffusion" name="covarianceDiffusion">
		<treeModel idref="treeModel"/>
		<discretizedBranchRates idref="branchRatesDiffusion"/>
	</rateCovarianceStatistic>    
	<multivariateTraitLikelihood id="traitLikelihood" traitName="trait"
        useTreeLength="false" scaleByTime="true"
        reportAsMultivariate="true" reciprocalRates="true">
		<multivariateDiffusionModel idref="diffusionModel"/>
		<treeModel idref="treeModel"/>
            <traitParameter>
                <parameter idref="allTraits"/>
            </traitParameter>
        <discretizedBranchRates idref="branchRatesDiffusion"/>
	</multivariateTraitLikelihood>    
	<correlation id="locationCorrelation" dimension1="1" dimension2="2">
		<matrixParameter idref="precisionMatrix"/>
	</correlation>    
    <treeLengthStatistic id="treeLength">
        <treeModel idref="treeModel"/>
    </treeLengthStatistic>    
    <productStatistic id="treeLengthPrecision1">
        <treeLengthStatistic idref="treeLength"/>
        <subStatistic id="precision1" dimension="0">
            <parameter idref="col1"/>
        </subStatistic>
    </productStatistic>    
    <productStatistic id="treeLengthPrecision2">
        <treeLengthStatistic idref="treeLength"/>
        <subStatistic id="precision2" dimension="1">
            <parameter idref="col2"/>
        </subStatistic>
    </productStatistic>    
	<treeDispersionStatistic id="dispersionRate" greatCircleDistance="true">
		<treeModel idref="treeModel"/>
		<multivariateTraitLikelihood idref="traitLikelihood"/>
	</treeDispersionStatistic>

    <!-- Taxon Sets                                                              -->
	<tmrcaStatistic id="tmrca(Karafuto)">
        <mrca>
            <taxa idref="Karafuto"/></mrca>
        <treeModel idref="treeModel"/>
	</tmrcaStatistic>
	<monophylyStatistic id="monophyly(Karafuto)">
        <mrca><taxa idref="Karafuto"/>
        </mrca>
        <treeModel idref="treeModel"/>
	</monophylyStatistic>
	<tmrcaStatistic id="tmrca(Hokkaido)">
        <mrca>
            <taxa idref="Hokkaido"/>
        </mrca>
        <treeModel idref="treeModel"/>
	</tmrcaStatistic>
	<monophylyStatistic id="monophyly(Hokkaido)">
        <mrca><taxa idref="Hokkaido"/></mrca>
        <treeModel idref="treeModel"/>
	</monophylyStatistic>
	<flatGeoSpatialPrior id="geoPrior" kmlFileName="Umi.kml" inside="false">
		<data>
			<parameter idref="internalTraits"/>
		</data>
	</flatGeoSpatialPrior>

	<!-- Define operators                                                        -->
	<operators id="operators" optimizationShedule="log">		
		<scaleOperator scaleFactor="0.75" weight="3">
			<parameter idref="ucld.stdev"/>
		</scaleOperator>		
		<swapOperator size="1" weight="10.0" autoOptimize="false">
			<parameter idref="branchRates.categories"/>
		</swapOperator>
		<randomWalkIntegerOperator windowSize="2" weight="10.0">
			<parameter idref="branchRates.categories"/>
		</randomWalkIntegerOperator>
		<uniformIntegerOperator weight="10.0">
			<parameter idref="branchRates.categories"/>
		</uniformIntegerOperator>
        <scaleOperator scaleFactor="0.9" weight="1">
			<parameter idref="cognate.loss"/>
    	</scaleOperator>
        <upDownOperator scaleFactor="0.75" weight="3">
			<up>
				<parameter idref="cognate.loss"/>
			</up>
			<down>
				<parameter idref="treeModel.allInternalNodeHeights"/>
			</down>
		</upDownOperator>
        <scaleOperator scaleFactor="0.75" weight="15">
			<parameter idref="skyline.popSize"/>
		</scaleOperator>
		<deltaExchange delta="1" integer="true" weight="6" autoOptimize="false">
			<parameter idref="skyline.groupSize"/>
		</deltaExchange>        
		<scaleOperator scaleFactor="0.75" weight="3.0">
			<parameter idref="treeModel.rootHeight"/>
		</scaleOperator>
		<uniformOperator weight="30.0">
			<parameter idref="treeModel.internalNodeHeights"/>
		</uniformOperator>
		<subtreeSlide size="30.0" gaussian="true" weight="15.0">
			<treeModel idref="treeModel"/>
		</subtreeSlide>
		<narrowExchange weight="15.0">
			<treeModel idref="treeModel"/>
		</narrowExchange>
		<wideExchange weight="3.0">
			<treeModel idref="treeModel"/>
		</wideExchange>
		<wilsonBalding weight="3.0">
			<treeModel idref="treeModel"/>
		</wilsonBalding>
        <scaleOperator scaleFactor="0.75" weight="1">
			<parameter idref="diffusion.halfDF"/>
		</scaleOperator>
        <swapOperator size="1" weight="30" autoOptimize="false">
			<parameter idref="branchRatesDiffusion.categories"/>
		</swapOperator>
		<randomWalkIntegerOperator windowSize="2" weight="10.0">
			<parameter idref="branchRatesDiffusion.categories"/>
		</randomWalkIntegerOperator>
		<uniformIntegerOperator weight="10.0">
			<parameter idref="branchRatesDiffusion.categories"/>
		</uniformIntegerOperator>
	    <precisionGibbsOperator weight="15">
            <multivariateTraitLikelihood idref="traitLikelihood"/>
			<multivariateWishartPrior idref="precisionPrior"/>
	    </precisionGibbsOperator>        
        <traitGibbsOperator weight="50" onlyInternalNodes="false">
			<multivariateTraitLikelihood idref="traitLikelihood"/>
			<multivariateNormalPrior idref="rootPrior"/>
			<flatGeoSpatialPrior idref="geoPrior"/>
        </traitGibbsOperator>        
        <randomWalkOperator windowSize="10" weight="5">
			<parameter idref="rootTrait"/>
	    </randomWalkOperator>
	</operators>

	<!-- Define MCMC                                                             -->
	<mcmc id="mcmc" chainLength="20000000" autoOptimize="true" operatorAnalysis="Ainu_UCLD_GRRW_SDollo.ops">
		<posterior id="posterior">
			<prior id="prior">
                <generalizedSkyLineLikelihood idref="skyline"/>
				<exponentialMarkovLikelihood idref="eml1"/>
                <exponentialPrior mean="0.4" offset="0.0">
                	<statistic idref="ucld.stdev"/>
                </exponentialPrior>
	            <multivariateNormalPrior idref="rootPrior"/>
				<multivariateWishartPrior idref="precisionPrior"/>
				<gammaPrior id="deathRatePrior" scale="1" shape="0.0001" offset="0">
					<parameter idref="cognate.loss"/>
				</gammaPrior>
				<booleanLikelihood>
					<monophylyStatistic idref="monophyly(Karafuto)"/>
					<monophylyStatistic idref="monophyly(Hokkaido)"/>
                </booleanLikelihood>
                <exponentialPrior mean="1" offset="0.0">
                	<statistic idref="diffusion.halfDF"/>
                </exponentialPrior>
                <normalPrior mean="460" stdev="51.00">
					<statistic idref="tmrca(Karafuto)"/>
				</normalPrior>
                <flatGeoSpatialPrior idref="geoPrior"/>
			</prior>
			<likelihood id="likelihood">
				<treeLikelihood idref="bdLikelihood"/>
				<multivariateTraitLikelihood idref="traitLikelihood"/>
            </likelihood>
		</posterior>
		<operators idref="operators"/>

		<!-- write log to screen                                                     -->
		<log id="screenLog" logEvery="10000">
			<column label="Posterior" dp="4" width="12">
				<posterior idref="posterior"/>
			</column>
			<column label="Prior" dp="4" width="12">
				<prior idref="prior"/>
			</column>
			<column label="Likelihood" dp="4" width="12">
				<likelihood idref="likelihood"/>
			</column>
			<column label="Root Height" sf="6" width="12">
				<parameter idref="treeModel.rootHeight"/>
			</column>
			<column label="RootTrait" sf="6" width="12">
				<rateStatistic idref="rootTrait"/>
            </column>
		</log>

		<!-- write log to file                                                       -->
		<log id="fileLog" logEvery="10000" fileName="Ainu_UCLD_GRRW_SDollo.log" overwrite="false">
			<posterior idref="posterior"/>
			<prior idref="prior"/>
			<likelihood idref="likelihood"/>
			<parameter idref="ucld.mean"/>
			<parameter idref="ucld.stdev"/>
			<rateStatistic idref="meanRate"/>
            <parameter idref="treeModel.rootHeight"/>
			<tmrcaStatistic idref="tmrca(Karafuto)"/>
            <tmrcaStatistic idref="tmrca(Hokkaido)"/>
			<monophylyStatistic idref="monophyly(Karafuto)"/>
			<monophylyStatistic idref="monophyly(Hokkaido)"/>
            <parameter idref="cognate.loss"/>
            <parameter idref="skyline.popSize"/>
			<parameter idref="skyline.groupSize"/>
            <rateStatistic idref="coefficientOfVariation"/>
			<rateCovarianceStatistic idref="covariance"/>
			<matrixParameter idref="precisionMatrix"/>
			<parameter idref="rootTrait"/>
            <parameter idref="diffusion.halfDF"/>
			<treeDispersionStatistic idref="dispersionRate"/>
			<productStatistic idref="treeLengthPrecision1"/>
			<productStatistic idref="treeLengthPrecision2"/>
 			<correlation idref="locationCorrelation"/>
			<rateStatistic idref="coefficientOfVariationDiffusion"/>
			<rateCovarianceStatistic idref="covarianceDiffusion"/>
            <multivariateTraitLikelihood idref="traitLikelihood"/>
            <treeLikelihood idref="bdLikelihood"/>
            <generalizedSkyLineLikelihood idref="skyline"/>
		</log>

		<!-- write tree log to file                                                  -->
		<logTree id="treeFileLog" logEvery="10000" nexusFormat="true" fileName="Ainu_UCLD_GRRW_SDollo.trees" sortTranslationTable="true">
			<treeModel idref="treeModel"/>
			<discretizedBranchRates idref="branchRates"/>
			<posterior idref="posterior"/>
		</logTree>
        <!-- reports info about diffusion model -->
		<logTree id="geoTreeFileLog" logEvery="10000" nexusFormat="true" fileName="Ainu_UCLD_GRRW_SDollo_Diffusion.trees" sortTranslationTable="true">
			<treeModel idref="treeModel"/>
			<discretizedBranchRates idref="branchRatesDiffusion"/>
			<multivariateDiffusionModel idref="diffusionModel"/>
            <multivariateTraitLikelihood idref="traitLikelihood"/>
			<posterior idref="posterior"/>
		</logTree>
	</mcmc>
     
	<!--marginalLikelihoodEstimator chainLength="100000" pathSteps="100" pathScheme="betaquantile" alpha="0.30">
    	<samplers>
	        <mcmc idref="mcmc"/>
	    </samplers>
        <pathLikelihood id="pathLikelihood">
            <source>
                <posterior idref="posterior"/>
            </source>
            <destination>
                <prior idref="prior"/>
            </destination>
        </pathLikelihood>
        <log id="MLE-Log-0-1.con" logEvery="1000" fileName="MLE-Log-0-1.con.log">
            <pathLikelihood idref="pathLikelihood"/>
        </log>
    </marginalLikelihoodEstimator>
     <pathSamplingAnalysis fileName="MLE-Log-0-1.con.log">
        <likelihoodColumn name="pathLikelihood.delta"/>
        <thetaColumn name="pathLikelihood.theta"/>      
    </pathSamplingAnalysis>
	<steppingStoneSamplingAnalysis fileName="MLE-Log-0-1.con.log">
        <likelihoodColumn name="pathLikelihood.delta"/>
        <thetaColumn name="pathLikelihood.theta"/>      
    </steppingStoneSamplingAnalysis-->
     
    <report>
		<property name="timer">
			<mcmc idref="mcmc"/>
		</property>
	</report>
</beast>
